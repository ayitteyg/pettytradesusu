<div class="dashboard-container">
    <!-- Welcome Banner with Profile -->

    <div class="p-5">
        <div class="avatarr">{{memberId || ""}}</div>
        <div>
            <h2 class="fs-5 text-muted">Welcome, {{username}}</h2>
            <div class="">
                <!-- <span class="badge church-badge">{{church}}</span> -->

            </div>
        </div>
    </div>



    <div *ngIf="loading" class="text-center my-5">
        <div class="spinner-border text-primary" role="status"></div>
        <p>Loading dashboard data...</p>
    </div>


    <div *ngIf="!loading">

        <!-- Summary Cards Grid -->
        <div class="summary-grid">
            <div class="summary-card shadoww bg-sv-crd savings-card">
                <div class="card-iconn bg-sv-crd p-3">
                    <i class="bi bi-bank"></i>
                </div>
                <div class="card-content">
                    <p class="card-label text-light fs-6">TOTAL SAVINGS</p>
                    <h3 class="card-value">GHS {{ totalSavings | number: '1.2-2' }}</h3>
                    <p class="text-light">YTD</p>
                </div>
            </div>

            <div class="summary-card shadoww bg-wtd-crd loan-card">
                <div class="card-iconn bg-wtd-crd p-3">
                    <i class="bi bi-cash"></i>
                </div>
                <div class="card-content">
                    <!-- <button class="btn btn-outline-danger request-withdrawal">Request</button> -->
                    <p class="card-label text-light  fs-6">TOTAL WITHDRAWALS</p>
                    <h3 class="card-value">GHS {{ totalWithdrawals | number: '1.2-2' }}</h3>
                    <p class="text-light">YTD</p>
                </div>
            </div>

            <div class="summary-card shadoww bg-bal-crd repayment-card">
                <div class="card-iconn  bg-bal-crd p-3">
                    <i class="bi bi-calendar-check"></i>
                </div>
                <div class="card-content">
                    <p class="card-label text-light  fs-6 ">ACCOUNT BALANCE</p>
                    <h3 class="card-value">GHS {{ currentBalance | number: '1.2-2' }}</h3>
                    <p class="text-light">YTD</p>
                </div>
            </div>
        </div>

        <!-- Recent Transactions / Chart -->
        <div class="recent-transactions">
            <div class="row">

                <div class="col-lg-6 col-sm-12">

                    <button mat-raised-button color="primary" (click)="openTransactionsModal()" class="text-end">
                        View All Transactions
                     </button>
                    <div class="col-lg-12 col-sm-12 shadow">
                        <div class="d-flex flex-column gap-3 t-container">
                            <div *ngFor="let t of recentTransactions; let i = index" class="mb-4">
                                <div class="trans-card">
                                    <div class="d-flex loan-tag-date justify-content-between">
                                        <div class="d-flex">
                                            <p class="me-2">{{ i + 1 }}</p>
                                            <a>{{ t.date | date: 'MMM dd, y' }}</a>
                                        </div>
                                        <div class="d-flex trans-toggle">
                                            <h6 class="badge bg-success" (click)="toggleTable(i)">
                                                {{ showTable[i] ? 'Hide' : 'View' }} Details
                                            </h6>
                                        </div>
                                    </div>
                                    <div class="t-card">
                                        <div class="card-body">
                                            <div *ngIf="showTable[i]">
                                                <table class="table table-bordered">
                                                    <tbody>
                                                        <tr class="transaction-meta">
                                                            <th class="text-start">Date</th>
                                                            <td class="text-start">{{ t.date | date }}</td>
                                                        </tr>
                                                        <tr class="transaction-meta">
                                                            <th class="text-start">Type</th>
                                                            <td class="text-start">{{ t.type }}</td>
                                                        </tr>
                                                        <tr class="transaction-meta">
                                                            <th class="text-start">Details</th>
                                                            <td class="text-start">{{ t.description }}</td>
                                                        </tr>
                                                        <tr class="transaction-meta">
                                                            <th class="text-start">Amount</th>
                                                            <td class="text-start" [ngClass]="t.type === 'withdrawal' ? 'negative' : 'positive'">
                                                                {{ t.amount | currency: 'GHS' : 'symbol' : '1.2-2' }}
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div *ngIf="recentTransactions.length === 0" class="text-muted text-center py-3">
                                No transactions found.
                            </div>
                        </div>
                    </div>
                </div>



                <div class="col-lg-6 col-sm-12">
                    <div class="cardd t-container pt-3">
                        <div class="card-body">
                            <canvas id="savingsChart" height="120"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

</div>